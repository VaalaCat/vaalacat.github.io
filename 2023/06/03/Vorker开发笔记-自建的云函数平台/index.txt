1:HL["/_next/static/css/03e6659c09723aab.css",{"as":"style"}]
0:[[["",{"children":[["year","2023","d"],{"children":[["mon","06","d"],{"children":[["date","03","d"],{"children":[["name","Vorker%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0-%E8%87%AA%E5%BB%BA%E7%9A%84%E4%BA%91%E5%87%BD%E6%95%B0%E5%B9%B3%E5%8F%B0","d"],{"children":["__PAGE__?{\"year\":\"2023\",\"mon\":\"06\",\"date\":\"03\",\"name\":\"Vorker开发笔记-自建的云函数平台\"}",{}]}]}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/03e6659c09723aab.css","precedence":"next"}]],["$L3",null]]]]
4:HL["/_next/static/css/633a9ad1601bb6ee.css",{"as":"style"}]
5:I{"id":"4304","chunks":["16:static/chunks/16-ac25bf4963a321a9.js","700:static/chunks/700-52cc25b5c0cceee9.js","185:static/chunks/app/layout-d53dd8a635c1ccdf.js"],"name":"Providers","async":false}
6:I{"id":"7801","chunks":["16:static/chunks/16-ac25bf4963a321a9.js","700:static/chunks/700-52cc25b5c0cceee9.js","185:static/chunks/app/layout-d53dd8a635c1ccdf.js"],"name":"ModeToggle","async":false}
7:I{"id":"1016","chunks":["16:static/chunks/16-ac25bf4963a321a9.js","700:static/chunks/700-52cc25b5c0cceee9.js","185:static/chunks/app/layout-d53dd8a635c1ccdf.js"],"name":"","async":false}
8:I{"id":"674","chunks":["272:static/chunks/webpack-530677b095e440d7.js","115:static/chunks/e5a6a3a4-3bb818ecd9bb262c.js","313:static/chunks/313-7e64359f4c0a3e6a.js"],"name":"","async":false}
9:I{"id":"2236","chunks":["272:static/chunks/webpack-530677b095e440d7.js","115:static/chunks/e5a6a3a4-3bb818ecd9bb262c.js","313:static/chunks/313-7e64359f4c0a3e6a.js"],"name":"","async":false}
b:I{"id":"5284","chunks":["16:static/chunks/16-ac25bf4963a321a9.js","700:static/chunks/700-52cc25b5c0cceee9.js","185:static/chunks/app/layout-d53dd8a635c1ccdf.js"],"name":"Analytics","async":false}
2:[["$","html",null,{"lang":"en","children":[["$","link",null,{"rel":"stylesheet","href":"https://cdnjs.cloudflare.com/ajax/libs/lxgw-wenkai-webfont/1.7.0/style.min.css"}],["$","body",null,{"className":"antialiased min-h-screen bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50","children":["$","$L5",null,{"children":[["$","div",null,{"className":"max-w-2xl mx-auto py-10 px-4","children":[["$","header",null,{"children":["$","div",null,{"className":"flex items-center justify-between","children":[["$","$L6",null,{}],["$","$L7",null,{"href":"/atom.xml","target":"_blank","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-rss ml-3 border rounded-md p-1 w-6 h-6 flex items-center justify-center","children":[["$","path","pv89mb",{"d":"M4 11a9 9 0 0 1 9 9"}],["$","path","k0647b",{"d":"M4 4a16 16 0 0 1 16 16"}],["$","circle","bfqh0e",{"cx":"5","cy":"19","r":"1"}],"$undefined"]}]}],["$","nav",null,{"className":"ml-auto text-sm font-medium space-x-6","children":[["$","$L7",null,{"href":"/","className":"hover:text-sky-500","children":"Home"}],["$","$L7",null,{"href":"/about","className":"hover:text-sky-500","children":"About"}],["$","$L7",null,{"href":"/link","className":"hover:text-sky-500","children":"Friends"}]]}]]}]}],["$","main",null,{"children":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2023","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2023","d"],"children",["mon","06","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2023","d"],"children",["mon","06","d"],"children",["date","03","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2023","d"],"children",["mon","06","d"],"children",["date","03","d"],"children",["name","Vorker%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0-%E8%87%AA%E5%BB%BA%E7%9A%84%E4%BA%91%E5%87%BD%E6%95%B0%E5%B9%B3%E5%8F%B0","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$La",null],"segment":"__PAGE__?{\"year\":\"2023\",\"mon\":\"06\",\"date\":\"03\",\"name\":\"Vorker开发笔记-自建的云函数平台\"}"},"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/633a9ad1601bb6ee.css","precedence":"next"}]]}],"segment":["name","Vorker%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0-%E8%87%AA%E5%BB%BA%E7%9A%84%E4%BA%91%E5%87%BD%E6%95%B0%E5%B9%B3%E5%8F%B0","d"]},"styles":[]}],"segment":["date","03","d"]},"styles":[]}],"segment":["mon","06","d"]},"styles":[]}],"segment":["year","2023","d"]},"styles":[]}]}],["$","footer",null,{"children":["$","p",null,{"className":"text-sm text-slate-500 dark:text-slate-400 text-center mb-0 sm:mb-10","children":["Copyrights © ",2024," VaalaCat. All Rights Reserved."]}]}]]}],["$","$Lb",null,{}]]}]}]]}],null]
3:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"Vorker开发笔记-自建的云函数平台"}],null,null,null,null,null,null,null,null,null,["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]],[],null]]
c:I{"id":"4083","chunks":["232:static/chunks/ad809e52-8ff9ed3aaf334a74.js","249:static/chunks/7f34000f-53a298e23e93d2d0.js","206:static/chunks/c6f2715a-9295945954d32d44.js","578:static/chunks/578-5ca193d330e7469e.js","11:static/chunks/11-58372cdb3fd1b1af.js","629:static/chunks/629-cdae87bfb6a1efc0.js","227:static/chunks/app/[year]/[mon]/[date]/[name]/page-eed0d1efead3008a.js"],"name":"PostContent","async":false}
a:["$","article",null,{"className":"py-6 prose dark:prose-invert","children":[["$","div",null,{"className":"text-sm text-red-400 mb-2","children":["本文链接已迁移到: ",["$","a",null,{"className":"text-red-400 font-light","href":"/posts/Vorker开发笔记-自建的云函数平台","children":"/posts/Vorker开发笔记-自建的云函数平台"}]]}],["$","$Lc",null,{"post":{"title":"Vorker开发笔记-自建的云函数平台","date":"2023-06-03T22:58:48.000Z","body":{"raw":"","code":"var Component=(()=>{var d=Object.create;var i=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var u=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),f=(r,e)=>{for(var l in e)i(r,l,{get:e[l],enumerable:!0})},o=(r,e,l,a)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of m(e))!k.call(r,s)&&s!==l&&i(r,s,{get:()=>e[s],enumerable:!(a=p(e,s))||a.enumerable});return r};var w=(r,e,l)=>(l=r!=null?d(g(r)):{},o(e||!r||!r.__esModule?i(l,\"default\",{value:r,enumerable:!0}):l,r)),N=r=>o(i({},\"__esModule\",{value:!0}),r);var c=u((v,t)=>{t.exports=_jsx_runtime});var W={};f(W,{default:()=>E,frontmatter:()=>j});var n=w(c()),j={title:\"Vorker\\u5F00\\u53D1\\u7B14\\u8BB0-\\u81EA\\u5EFA\\u7684\\u4E91\\u51FD\\u6570\\u5E73\\u53F0\",date:new Date(1685833128e3),tags:[\"\\u9879\\u76EE\",\"\\u5F00\\u53D1\",\"golang\",\"vue\",\"websocket\",\"socketio\",\"gin\"],category:[[\"Technique\",\"Code\"]]};function h(r){let e=Object.assign({p:\"p\",a:\"a\",h2:\"h2\",blockquote:\"blockquote\",del:\"del\",ol:\"ol\",li:\"li\",img:\"img\",h3:\"h3\",pre:\"pre\",code:\"code\",span:\"span\",ul:\"ul\"},r.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"\\u9879\\u76EE\\u5730\\u5740\\uFF1A\",(0,n.jsx)(e.a,{href:\"https://github.com/VaalaCat/vorker\",children:\"https://github.com/VaalaCat/vorker\"})]}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u5F15\\u8A00\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u535A\\u5BA2\\u770B\\u8D77\\u6765\\u6709\\u4E00\\u5E74\\u6CA1\\u66F4\\u65B0\\u5566\\uFF0C\\u52A0\\u5165\\u8DF3\\u4E0D\\u52A8\\u516C\\u53F8\\u8FC7\\u540E\\u771F\\u7684\\u8DF3\\u4E0D\\u52A8\\u4E86QwQ\\u3002\\u6700\\u8FD1\\u7422\\u78E8\\u7740\\u8FD8\\u662F\\u8BE5\\u5199\\u70B9\\u4EC0\\u4E48\\u514D\\u5F97\\u8BA9\\u5927\\u5BB6\\u4EE5\\u4E3A\\u6211\\u8D5B\\u535A\\u5931\\u8E2A\\uFF0C\\u8FD9\\u6B21\\u7684\\u9879\\u76EE\\u6211\\u7ED9\\u5B83\\u53D6\\u540D\\u4E3AVoker\\u3002\\u5176\\u57FA\\u4E8ECloudflare\\u516C\\u53F8\\u5F00\\u6E90\\u7684\",(0,n.jsx)(e.a,{href:\"https://github.com/cloudflare/workerd\",children:\"Workerd\"}),\"\\uFF0C\\u8FD9\\u4E2AWorkerd\\u5C31\\u662FCF\\u77E5\\u540D\\u4EA7\\u54C1\",(0,n.jsx)(e.a,{href:\"https://workers.cloudflare.com/\",children:\"Cloudflare Worker\"}),\"\\u7684\\u5F15\\u64CE\\u3002\\u4F46CF\\u4EC5\\u5F00\\u6E90\\u4E86\\u5F15\\u64CE\\uFF0C\\u53E6\\u5916\\u7684\\u80FD\\u529B\\u5982\\u8FD0\\u884C\\u7F16\\u6392\\u3001KV\\u5B58\\u50A8\\u3001\\u63A7\\u5236\\u9762\\u677F\\u3001\\u7248\\u672C\\u63A7\\u5236\\u3001\\u65E5\\u5FD7\\u7EDF\\u8BA1\\u6536\\u96C6\\u3001\\u7528\\u6237\\u6743\\u9650\\u7B49\\u529F\\u80FD\\u5E76\\u6CA1\\u6709\\u516C\\u5F00\\uFF0C\\u6240\\u4EE5\\u9700\\u8981\\u81EA\\u5DF1\\u5B8C\\u5584\\u8FD9\\u65B9\\u9762\\u7684\\u80FD\\u529B\\u3002\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u4EE3\\u7801\\u548C\\u4F7F\\u7528\\u8BF4\\u660E\\u53C2\\u8003Github\\uFF1A\",(0,n.jsx)(e.a,{href:\"https://github.com/VaalaCat/vorker\",children:\"Vorker\"})]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u8FD9\\u6B21\\u8981\\u505A\\u7684\\u5C31\\u662FCloudflare Worker\\u7684\\u81EA\\u6258\\u7BA1(Self Hosting)\\u7248\\u672C\\uFF0C\\u4EE3\\u7801\\u6267\\u884C\\u80FD\\u529B\\u7531CF\\u5F00\\u6E90workerd\\u7EC4\\u4EF6\\u63D0\\u4F9B\\uFF0C\\u5176\\u4F59\\u80FD\\u529B\\u81EA\\u884C\\u5F00\\u53D1\\u5B8C\\u6210\"}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"\\u4E4B\\u6240\\u4EE5\\u53EBVoker\\uFF0C\\u56E0\\u4E3A\\u505A\\u51FA\\u6765\\u7684\\u4E1C\\u897F\\u76F8\\u6BD4Worker\\u4E0D\\u5B8C\\u5584\\uFF0C\\u6240\\u4EE5\\u628AW\\u780D\\u4E00\\u534A\\u5C31\\u53D8\\u6210V\\u4E86\\uFF0C\",(0,n.jsx)(e.del,{children:\"\\u540C\\u65F6\\u505A\\u7684\\u65F6\\u5019\\u4EBA\\u5FEB\\u6CA1\\u4E86\\uFF0C\\u6240\\u4EE5\\u5C11\\u4E86\\u4E2Ar\\uFF08qqqq\"}),\"\\u4EE5\\u524D\\u53EBvoker\\uFF0C\\u73B0\\u5728\\u62C9\\u4E86\\u4E00\\u4E2Asems\\u548C\\u6211\\u4E00\\u8D77\\uFF0C\\u4EBA\\u8FD8\\u662F\\u5728\\u7684\"]}),`\n`]}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u9700\\u6C42\\u4ECB\\u7ECD\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u6B64\\u6B21\\u7684\\u9700\\u6C42\\u662F\\u5B8C\\u6210\\u4E00\\u4E2A\\u81EA\\u6258\\u7BA1\\u7248\\u672C\\u7684Worker\\uFF0C\\u4E3B\\u8981\\u539F\\u56E0\\u662F\\uFF1A\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"CF\\u7684worker\\u57DF\\u540D\\u88AB\\u5899\\uFF0C\\u867D\\u7136\\u53EF\\u4EE5\\u7528\\u81EA\\u5DF1\\u7684\\u57DF\\u540D\\uFF0C\\u4F46\\u603B\\u4F53\\u6765\\u8BF4\\u56FD\\u5185\\u4F7F\\u7528\\u4F53\\u9A8C\\u5E76\\u4E0D\\u597D\"}),`\n`,(0,n.jsx)(e.li,{children:\"Free Plan\\u6709\\u9650\\u989D\\uFF0C\\u867D\\u7136\\u6211\\u7528\\u4E0D\\u5B8C\\uFF0C\\u4F46\\u662F\\u770B\\u7740\\u8FD8\\u662F\\u4E0D\\u723D\\uFF0C\\u6BD5\\u7ADF\\u81EA\\u5DF1\\u6709\\u673A\\u5668\\u53EF\\u4EE5\\u4E0D\\u9650\\u989D\\u7684\\u5462\"}),`\n`,(0,n.jsx)(e.li,{children:\"\\u53EF\\u5B9A\\u5236\\u80FD\\u529B\\u7F3A\\u5931\\uFF0CCF\\u6BD5\\u7ADF\\u662FCF\\uFF0C\\u4E2A\\u4EBA\\u7528\\u6237\\u7684\\u4E00\\u4E9Bfeature\\u8FD8\\u662F\\u8003\\u8651\\u4E0D\\u592A\\u5B8C\\u5584\\uFF0C\\u7528\\u7740\\u6709\\u70B9\\u618B\\u5C48\\uFF0C\\u81EA\\u5DF1\\u5199\\u5C31\\u80FD\\u5F88\\u8F7B\\u677E\\u7684\\u548CGit\\u4ED3\\u5E93\\u914D\\u5408\\u4E0ACI/CD\"}),`\n`,(0,n.jsx)(e.li,{children:\"\\u6211\\u81EA\\u5DF1\\u5F00\\u65B0\\u9879\\u76EE\\u7684\\u65F6\\u5019\\u4E0D\\u7528\\u5199\\u4E00\\u5927\\u5806\\u7684\\u73AF\\u5883\\u914D\\u7F6E\\u811A\\u672C\\u548CCICD\\u914D\\u7F6E\\uFF0C\\u6781\\u5927\\u63D0\\u5347\\u4E86\\u6211\\u5F00\\u53D1\\u6548\\u7387\\u548C\\u4F53\\u9A8C\\uFF0C\\u5BF9\\u4E8E\\u4E00\\u4E9B\\u5C0F\\u9879\\u76EE\\uFF0C\\u65E0\\u9700\\u518D\\u914D\\u7F6E\\u53CD\\u5411\\u4EE3\\u7406\\u3001\\u8DEF\\u7531\\u89C4\\u5219\\u3001\\u8FD0\\u884C\\u7684\\u8282\\u70B9\\u4FE1\\u606F\\u3001SSL\\u3001\\u72EC\\u7ACB\\u6570\\u636E\\u5E93\\u8868\\u7B49\\uFF0C\\u540C\\u65F6Debug\\u4E5F\\u65B9\\u4FBF\\u5F97\\u591A\\uFF0C\\u4E0D\\u7528\\u5728\\u7F16\\u8BD1\\u3001\\u4E0A\\u7EBF\\u7B49\\u7B49\\u7B49\"}),`\n`]}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u660E\\u786E\\u76EE\\u6807\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5BF9\\u4E8E\\u4EE5\\u4E0A\\u9700\\u6C42\\uFF0C\\u9700\\u8981\\u8FBE\\u5230\\u7684\\u4E00\\u4E9B\\u76EE\\u6807\\u5982\\u4E0B\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"\\u9700\\u8981\\u4E00\\u4E2A\\u63A7\\u5236\\u9762\\u7684API\\uFF0C\\u80FD\\u591F\\u8F7B\\u677E\\u63A7\\u5236\\u6BCF\\u5957\\u4EE3\\u7801\\u7684\\u90E8\\u7F72\\u60C5\\u51B5\"}),`\n`,(0,n.jsx)(e.li,{children:\"\\u9700\\u8981\\u5728\\u63A7\\u5236\\u9762\\u505A\\u53CD\\u5411\\u4EE3\\u7406\\uFF0C\\u5C06Workerd\\u7684\\u6BCF\\u4E00\\u4E2Aworker\\u6620\\u5C04\\u5230\\u5BF9\\u5E94\\u7684\\u57DF\\u540D\"}),`\n`,(0,n.jsx)(e.li,{children:\"\\u9700\\u8981\\u4E00\\u4E2AWebUI\\uFF0C\\u65B9\\u4FBF\\u968F\\u65F6\\u66F4\\u65B0\\u4EE3\\u7801\\uFF08\\u624B\\u673A\\u7B49\"}),`\n`,(0,n.jsx)(e.li,{children:\"\\u9700\\u8981HA \\uFF08High Availability\\uFF09\\u90E8\\u7F72\\uFF0C\\u4E0D\\u7136\\u4E00\\u53F0\\u673A\\u5668\\u574F\\u4E86\\u6240\\u6709\\u4EE3\\u7801\\u90FD\\u5BC4\\u4E86\"}),`\n`,(0,n.jsx)(e.li,{children:\"\\u9700\\u8981\\u652F\\u6301\\u5916\\u90E8\\u53CD\\u5411\\u4EE3\\u7406\\uFF0C\\u6BD5\\u7ADF\\u81EA\\u5DF1\\u5199\\u7684\\u80AF\\u5B9A\\u6CA1\\u6709Traefik Nginx\\u7B49\\u80FD\\u529B\\u5F3A\"}),`\n`]}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u67B6\\u6784\\u8BBE\\u8BA1\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5BF9\\u4E8E\\u4EE5\\u4E0A\\u76EE\\u6807\\uFF0C\\u8BBE\\u8BA1\\u5982\\u4E0B\\u67B6\\u6784\\uFF1A\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/images/vorker/vorkerarch.svg\",alt:\"\"})}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u5B9E\\u73B0\"}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u540E\\u7AEF\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u524D\\u7AEF\\u91C7\\u7528Next.js/React/TailwindCSS/semi.desgin\\uFF0C\\u540E\\u7AEFGin/Golang/Workerd\\u3002\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u6700\\u5F00\\u59CB\\u8FD8\\u5728\\u601D\\u8003\\u5982\\u4F55\\u53BB\\u63A7\\u5236workerd\\u60F3\\u4E86\\u5F88\\u957F\\u65F6\\u95F4\\uFF0C\\u67D0\\u4E00\\u5929\\u770B\\u5230Gitea\\u91CC\\u64CD\\u4F5Cgit\\u662F\\u76F4\\u63A5cmd.run\\uFF0C\\u6211\\u76F4\\u63A5\\u5C31\\u662F\\u9707\\u60CA\\u{1F92F}\\uFF0C\\u6240\\u4EE5\\u6211\\u4E5F\\u76F4\\u63A5\\u5F00\\u6284\\u{1F60E}\\uFF0C\\u6240\\u4EE5worker\\u7684\\u542F\\u52A8\\u53C2\\u6570\\u662F\\u5728Vorker\\u91CC\\u62FC\\u8D77\\u6765\\u7684\\u3002\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Workerd\\u8FD0\\u884C\\u914D\\u7F6E\\u6587\\u4EF6\\u57FA\\u4E8E\",(0,n.jsx)(e.a,{href:\"https://capnproto.org/\",children:\"capnp\"}),\"\\uFF0C\\u8FD9\\u4E2AIDL\\u8D85\\u7EA7\\u5FEB\\uFF0C\\u56E0\\u4E3A\\u4ED6\\u7684\\u7ED3\\u6784\\u5B8C\\u5168\\u548C\\u5185\\u5B58\\u5E03\\u5C40\\u4E00\\u81F4\\u3002\\u4ED6\\u6709\\u4E00\\u4E2A\",(0,n.jsx)(e.a,{href:\"https://github.com/capnproto/go-capnp\",children:\"Go\\u5B9E\\u73B0\"}),\"\\uFF0C\\u672C\\u6765\\u6253\\u7B97\\u662F\\u7528\\u8FD9\\u4E2A\\u5E93\\u6309\\u7167\",(0,n.jsx)(e.a,{href:\"https://github.com/cloudflare/workerd/blob/main/src/workerd/server/workerd.capnp\",children:\"Workerd\\u7684Schema\"}),\"\\u53BB\\u751F\\u6210Workerd\\u7684\\u914D\\u7F6E\\u6587\\u4EF6\\uFF0C\\u4F46\\u662F\\u770B\\u4E86\\u4E00\\u773C\\u53D1\\u73B0Workerd\\u7684\\u914D\\u7F6E\\u5E76\\u6CA1\\u6709\\u56FA\\u5B9A\\u4E0B\\u6765\\uFF0C\\u6240\\u4EE5\\u6682\\u65F6\\u5148\\u5199\\u4E2A\\u7B80\\u5355\\u7684template\\u751F\\u6210\\u914D\\u7F6E\\u6587\\u4EF6\\u3002\"]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5BF9\\u4E8Eapi\\u90E8\\u5206\\u6CA1\\u4EC0\\u4E48\\u597D\\u8BF4\\u7684\\uFF0C\\u5C31\\u662FCRUD\\uFF0C\\u8981\\u6CE8\\u610F\\u4E00\\u70B9\\u662FVorker\\u5C06Workerd\\u7684\\u6BCF\\u4E00\\u4E2AWorker\\u6240\\u6709\\u4FE1\\u606F\\u90FD\\u5B58\\u50A8\\u5728\\u6570\\u636E\\u5E93\\u4E2D\\uFF0C\\u7136\\u540E\\u901A\\u8FC7\\u6570\\u636E\\u5E93\\u91CC\\u7684\\u4FE1\\u606F\\u751F\\u6210\\u914D\\u7F6E\\u6587\\u4EF6\\u7ED9Workerd\\u4F7F\\u7528\\u3002\\u8FD9\\u4E2A\\u8FC7\\u7A0B\\u4E2D\\u53EF\\u80FD\\u4F1A\\u51FA\\u73B0\\u4E0D\\u4E00\\u81F4\\uFF0CVorker\\u8BBE\\u8BA1\\u4E0A\\u662F\\u4EE5\\u6570\\u636E\\u5E93\\u4E3A\\u552F\\u4E00\\u53EF\\u4FE1\\u6570\\u636E\\u6E90\\uFF0C\\u5BF9\\u6587\\u4EF6\\u53EA\\u6709\\u5199\\u5165\\u64CD\\u4F5C\\uFF0C\\u6CA1\\u6709\\u8BFB\\u53D6\\uFF0C\\u56E0\\u6B64\\u5B9A\\u65F6\\u8C03\\u7528\\u63A5\\u53E3\\u5237\\u65B0\\u6587\\u4EF6\\u5373\\u53EF\\u3002\"}),`\n`,(0,n.jsx)(e.p,{children:\"Workerd\\u7684\\u5B9A\\u4E49\\u7528protobuf\\uFF0C\\u5B9A\\u4E49\\u5982\\u4E0B\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`syntax = \"proto3\";\npackage defs;\noption go_package = \"../entities\";\n\nmessage Worker {\n    string UID = 1; // Unique id of the worker\n    string ExternalPath = 2; // External path of the worker, default is '/'\n    string HostName = 3; // the workerd runner host name, default is 'localhost'\n    string NodeName = 4; // for future HA feature, default is 'default'\n    int32 Port = 5; // worker's port, platfrom will obtain free port while init worker\n    string Entry = 6; // worker's entry file, default is 'entry.js'\n    bytes Code = 7; // worker's code\n    string Name = 8; // worker's name, also use at worker routing, must be unique, default is UID\n}\n\n// one WorkerList for one workerd instance\nmessage WorkerList { \n    string ConfName = 1; // the name of the workerd instance\n    repeated Worker Workers = 2;\n    string NodeName = 3; // workerd runner host name, for HA\n}\n`})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u8DEF\\u7531\\u90E8\\u5206\\u540E\\u7EED\\u9700\\u8981\\u652F\\u6301\\u5916\\u90E8\\u53CD\\u5411\\u4EE3\\u7406\\uFF0C\\u5728Traefik\\u4E2D\\u6CE8\\u518C\\u8DEF\\u7531\\u5B9E\\u73B0\\u66F4\\u591A\\u529F\\u80FD\\u3002\\u4E5F\\u9700\\u8981\\u652F\\u6301\\u5185\\u90E8\\u53CD\\u5411\\u4EE3\\u7406\\uFF0C\\u5B9E\\u73B0\\u5982\\u4E0B\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"hljs language-go\",children:[(0,n.jsx)(e.span,{className:\"hljs-keyword\",children:\"package\"}),` proxy\n\n`,(0,n.jsx)(e.span,{className:\"hljs-keyword\",children:\"import\"}),` (\n    `,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"fmt\"'}),`\n    `,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"net/http/httputil\"'}),`\n    `,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"net/url\"'}),`\n    `,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"strings\"'}),`\n    `,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"voker/entities\"'}),`\n    `,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"voker/models\"'}),`\n\n    `,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"github.com/gin-gonic/gin\"'}),`\n    `,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"github.com/sirupsen/logrus\"'}),`\n)\n\n`,(0,n.jsxs)(e.span,{className:\"hljs-function\",children:[(0,n.jsx)(e.span,{className:\"hljs-keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"hljs-title\",children:\"init\"}),(0,n.jsx)(e.span,{className:\"hljs-params\",children:\"()\"})]}),` {\n    proxy := entities.GetProxy()\n    workerRecords, err := models.AdminGetAllWorkers()\n    `,(0,n.jsx)(e.span,{className:\"hljs-keyword\",children:\"if\"}),\" err != \",(0,n.jsx)(e.span,{className:\"hljs-literal\",children:\"nil\"}),` {\n        logrus.Errorf(`,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"failed to get all workers, err: %v\"'}),`, err)\n    }\n    workerList := &entities.WorkerList{\n        Workers: models.Trans2Entities(workerRecords),\n    }\n    proxy.InitProxyMap(workerList)\n}\n\n`,(0,n.jsxs)(e.span,{className:\"hljs-function\",children:[(0,n.jsx)(e.span,{className:\"hljs-keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"hljs-title\",children:\"Endpoint\"}),(0,n.jsx)(e.span,{className:\"hljs-params\",children:\"(c *gin.Context)\"})]}),` {\n    host := c.Request.Host\n    name := strings.Split(host, `,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\".\"'}),\")[\",(0,n.jsx)(e.span,{className:\"hljs-number\",children:\"0\"}),`]\n    port := entities.GetProxy().GetProxyPort(name)\n    `,(0,n.jsx)(e.span,{className:\"hljs-keyword\",children:\"if\"}),\" port == \",(0,n.jsx)(e.span,{className:\"hljs-number\",children:\"0\"}),` {\n        c.JSON(`,(0,n.jsx)(e.span,{className:\"hljs-number\",children:\"404\"}),\", gin.H{\",(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"code\"'}),\": \",(0,n.jsx)(e.span,{className:\"hljs-number\",children:\"1\"}),\", \",(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"error\"'}),\": \",(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"not found\"'}),`})\n        `,(0,n.jsx)(e.span,{className:\"hljs-keyword\",children:\"return\"}),`\n    }\n\n    remote, err := url.Parse(fmt.Sprintf(`,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"http://localhost:%v\"'}),`, port))\n    `,(0,n.jsx)(e.span,{className:\"hljs-keyword\",children:\"if\"}),\" err != \",(0,n.jsx)(e.span,{className:\"hljs-literal\",children:\"nil\"}),` {\n        logrus.Panic(err)\n    }\n\n    c.Request.URL.Path = c.Copy().Param(`,(0,n.jsx)(e.span,{className:\"hljs-string\",children:'\"name\"'}),`)\n    proxy := httputil.NewSingleHostReverseProxy(remote)\n    proxy.ServeHTTP(c.Writer, c.Request)\n}\n`]})}),`\n`,(0,n.jsx)(e.p,{children:\"\\u5728\\u542F\\u52A8\\u65F6\\u5C31\\u5C06\\u8DEF\\u7531\\u6570\\u636E\\u5199\\u5230\\u5185\\u5B58\\u91CC\\u3002\"}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u524D\\u7AEF\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u524D\\u7AEF\\u7531@sems\\u63A8\\u8350\\u4F7F\\u7528\\u4E86semidesign\\uFF0C\\u662F\\u5B57\\u8282\\u65B0\\u5F00\\u6E90\\u7684\\u7EC4\\u4EF6\\u5E93\\uFF0C\\u4E0D\\u5F97\\u4E0D\\u8BF4\\u786E\\u5B9E\\u597D\\u770B\\uFF0C\\u8FD8\\u80FD\\u7528\\u8BBE\\u8BA1\\u7A3F\\u5148\\u51FA\\u4E00\\u4E2A\\u4EE3\\u7801\\u521D\\u7A3F\\uFF0C\\u5C5E\\u4E8E\\u662F\\u540E\\u7AEF\\u798F\\u97F3\\u3002\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u6413\\u4E86\\u56DB\\u4E2A\\u9875\\u9762\\uFF0C\\u4F7F\\u7528\\u5E38\\u89C1\\u7684\\u4FA7\\u8FB9\\u680F+header+\\u5185\\u5BB9\\u5E03\\u5C40\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"admin\\uFF0C\\u4E3B\\u8981\\u7528\\u4E8Eworker\\u5217\\u8868\\u3001\\u7528\\u6237\\u8BBE\\u7F6E\\u7B49\"}),`\n`,(0,n.jsx)(e.li,{children:\"register\\uFF0C\\u7528\\u6237\\u6CE8\\u518C\"}),`\n`,(0,n.jsx)(e.li,{children:\"login\\uFF0C\\u7528\\u6237\\u767B\\u5F55\"}),`\n`,(0,n.jsx)(e.li,{children:\"editor\\uFF0C\\u7F16\\u8F91\\u4EE3\\u7801\\u3001\\u8BBE\\u7F6Eworker\"}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u4EE3\\u7801\\u7F16\\u8F91\\u5668\\u7528\\u4E86vscode\\u540C\\u6B3E\\u7684monaco\\uFF0C\\u5F04\\u4E0A\\u4E86js\\u7684\\u4EE3\\u7801\\u8865\\u5168\\uFF0C\\u5199\\u8D77\\u6765\\u611F\\u89C9\\u8FD8\\u662F\\u4E0D\\u9519\\u7684\\u3002\"}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u8FD0\\u884C\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:\"\\u9996\\u5148\\u8981\\u4E0B\\u8F7DWorkerd\\u7684binary\"}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:\"docker\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"hljs language-bash\",children:[`docker run -dit --name=vorker \\\\\n    -e DB_PATH=/path/to/workerd/db.sqlite \\\\\n    -e WORKERD_DIR=/path/to/workerd \\\\\n    -e WORKERD_BIN_PATH=/bin/workerd \\\\\n    -e DB_TYPE=sqlite \\\\\n    -e WORKER_LIMIT=10000 \\\\\n    -e WORKER_PORT=8080 \\\\\n    -e API_PORT=8888 \\\\\n    -e LISTEN_ADDR=0.0.0.0 \\\\\n    -e WORKER_DOMAIN_SUFFIX=example.com \\\\ `,(0,n.jsx)(e.span,{className:\"hljs-comment\",children:\"# concat with worker name and scheme\"}),`\n    -e SCHEME=http \\\\ `,(0,n.jsx)(e.span,{className:\"hljs-comment\",children:\"# external scheme\"}),`\n    -e ENABLE_REGISTER=`,(0,n.jsx)(e.span,{className:\"hljs-literal\",children:\"false\"}),` \\\\\n    -e COOKIE_NAME=authorization \\\\\n    -e COOKIE_AGE=21600 \\\\\n    -e COOKIE_DOMAIN=localhost `,(0,n.jsx)(e.span,{className:\"hljs-comment\",children:\"# change it to your domain \\\\\"}),`\n    -e JWT_SECRET=xxxxxxx \\\\\n    -e JWT_EXPIRETIME=6 \\\\\n    -p 8080:8080 \\\\\n    -p 8888:8888 \\\\\n    -v `,(0,n.jsx)(e.span,{className:\"hljs-variable\",children:\"$PWD\"}),`/workerd:/path/to/workerd \\\\\n    -v `,(0,n.jsx)(e.span,{className:\"hljs-variable\",children:\"$PWD\"}),`/workerd-linux-64:/bin/workerd \\\\\n    vaalacat/vorker:latest\n`]})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"\\u8BBF\\u95EE\",(0,n.jsx)(e.code,{children:\"http://localhost:8888\"}),\"\\u8FDB\\u5165\\u63A7\\u5236\\u53F0\\uFF0C\\u5728header\\u91CC\\u7684Host\\u5E26\\u4E0Aworker\\u7684\\u540D\\u5B57\\u5373\\u53EF\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.h3,{children:\"\\u8FD0\\u884C\\u622A\\u56FE\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\u7BA1\\u7406\\u754C\\u9762\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/images/vorker/vorkeradmin.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Worker\\u7F16\\u8F91\\u754C\\u9762\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/images/vorker/vorkeredit.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Worker\\u8FD0\\u884C\\u754C\\u9762\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/images/vorker/vorkerexec.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u603B\\u7ED3\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\u5FD9\\u6BD5\\u8BBE\\u5FD9\\u4E86\\u4E00\\u9635\\uFF0C\\u5728\\u8FD9\\u4E2A\\u9879\\u76EE\\u4E0A\\u5E76\\u6CA1\\u6709\\u6295\\u5165\\u5F88\\u591A\\u7684\\u65F6\\u95F4\\uFF0C\\u8BD5\\u7528\\u4E86\\u6700\\u65B0\\u7684\\u7528\\u4E8E\\u751F\\u4EA7\\u7684\\u524D\\u7AEF\\u6280\\u672F\\u6808\\uFF0C\\u81F3\\u4ECA\\u8FD8\\u6709HA\\u3001Log\\u3001Metrics\\u3001\\u5916\\u90E8\\u53CD\\u5411\\u4EE3\\u7406\\u7B49\\u672A\\u5B8C\\u5168\\u5B8C\\u6210\\uFF0C\\u4F46\\u662F\\u8FD9\\u4E1C\\u897F\\u5728\\u672A\\u5B8C\\u6210\\u7684\\u72B6\\u6001\\u5C31\\u5F88\\u597D\\u7528\\u4E86\\uFF0C\\u770B\\u8D77\\u6765\\u672A\\u6765\\u7684Serverless+WASM\\u8FD8\\u4F1A\\u5927\\u653E\\u5F02\\u5F69\\u3002\\u987A\\u4FBF\\u5728\\u8FD9\\u6BB5\\u65F6\\u95F4\\u8FD8\\u770B\\u4E86\",(0,n.jsx)(e.a,{href:\"https://github.com/lagonapp/lagon\",children:\"lagon\"}),\"\\u3001\",(0,n.jsx)(e.a,{href:\"https://github.com/windmill-labs/windmill\",children:\"Windmill\"}),\"\\u3001\",(0,n.jsx)(e.a,{href:\"https://github.com/labring/laf\",children:\"laf\"}),\"\\u7B49serverless function\\u5E73\\u53F0\\uFF0C\\u4F3C\\u4E4E\\u5BF9Serverless\\u6709\\u4E86\\u4EC0\\u4E48\\u5947\\u5999\\u7684\\u611F\\u89C9\\u{1F633}\\uFF0C\\u5E0C\\u671B\\u4EE5\\u540EVorker\\u4E5F\\u80FD\\u548C\\u77E5\\u540D\\u5F00\\u6E90\\u4EA7\\u54C1\\u4E00\\u6837\\u53D1\\u5C55\\u4E0B\\u53BB\\uFF5E\\uFF5E\\uFF5E\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Vorker\\u5DF2\\u7ECF\\u6210\\u4E3A\\u4E86Vaala\\u2601\\uFE0F\\u7684API\\u5C42\\u7684\\u91CD\\u8981\\u90E8\\u5206\\uFF0C\\u540E\\u7EED\\u6211\\u4E5F\\u4F1A\\u9646\\u7EED\\u5199\\u4E00\\u4E9B\\u5173\\u4E8E\\u5982\\u4F55\\u4ECE\\u88F8\\u91D1\\u5C5E\\u673A\\u5668\\u6784\\u5EFA\\u4E00\\u4E2A\\u4F01\\u4E1A\\u7EA7\\u7684\\u4E91\\u5E73\\u53F0\\u7684\\u6587\\u7AE0\\uFF0C\\u4F8B\\u5982\\u7528\\u6216\\u8005\\u4E0D\\u7528K8S\\u7684\\u7EDF\\u4E00\\u7F51\\u5173\\u3001SCM\\u3001\\u914D\\u7F6E\\u4E2D\\u5FC3\\u3001\\u5BB9\\u5668\\u8C03\\u5EA6\\u3001ServiceMesh\\u7B49\\uFF0C\\u5C3D\\u8BF7\\u671F\\u5F85\\uFF01\"}),`\n`,(0,n.jsx)(e.h2,{children:\"\\u53C2\\u8003\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://github.com/hisorange/opwork\",children:\"https://github.com/hisorange/opwork\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://gobyexample.com/writing-files\",children:\"https://gobyexample.com/writing-files\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://colobu.com/2020/12/27/go-with-os-exec/#%E5%B7%A5%E4%BD%9C%E8%B7%AF%E5%BE%84\",children:\"https://colobu.com/2020/12/27/go-with-os-exec/#%E5%B7%A5%E4%BD%9C%E8%B7%AF%E5%BE%84\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://ijayer.github.io/post/tech/code/golang/20171010-go-template/#%E9%81%8D%E5%8E%86slice-1\",children:\"https://ijayer.github.io/post/tech/code/golang/20171010-go-template/#%E9%81%8D%E5%8E%86slice-1\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://github.com/cloudflare/workerd\",children:\"https://github.com/cloudflare/workerd\"})}),`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://github.com/gin-gonic/gin/issues/1143\",children:\"https://github.com/gin-gonic/gin/issues/1143\"})}),`\n`]})]})}function b(r={}){let{wrapper:e}=r.components||{};return e?(0,n.jsx)(e,Object.assign({},r,{children:(0,n.jsx)(h,r)})):h(r)}var E=b;return N(W);})();\n;return Component;"},"_id":"posts/Vorker开发笔记-自建的云函数平台.mdx","_raw":{"sourceFilePath":"posts/Vorker开发笔记-自建的云函数平台.mdx","sourceFileName":"Vorker开发笔记-自建的云函数平台.mdx","sourceFileDir":"posts","contentType":"mdx","flattenedPath":"posts/Vorker开发笔记-自建的云函数平台"},"type":"Post","slug":"/posts/Vorker开发笔记-自建的云函数平台","slugAsParams":"Vorker开发笔记-自建的云函数平台"}}]]}]
